

      program flookup

!C     Module with function interface declarations.
      use ffastwigxj
      use fwigxjpf

!C     Function prototypes (not recommended, use only when you cannot use
!C     the module ffastwigxj)
!C     real*8 ffw3jj_get, ffw3jjl, ffw3jja, ffw3jja6
!C     real*8 ffw6jj_get, ffw6jjl, ffw6jja
!C     real*8 ffw9jj_get, ffw9jjl, ffw9jja

      implicit none

!C     Local variables
      real*8 val3j, val6j, val9j

      write (*,"(A)"), "FASTWIGXJ fortran test program"

!C     Load tables produced during build test.

      call ffastwigxj_load("test_table_18.3j",      3);


!C     For fallback to WIGXJPF when symbols too large for table.

      call fwig_table_init(2*100,9)
      call fwig_temp_init(2*100)

!C     Note that arguments are in two_j = 2*j.

      val3j = ffw3jja6(2* 10 , 2* 15 , 2* 10 ,2*(-3), 2* 12 , 2*(-9))

      write (*,"(A40,F25.15)"), "3J(10  15  10; -3  12  -9):", val3j;

!C     Remove tables from memory.
      
      call ffastwigxj_unload(3);

      
!C     Release WIGXJPF memory.

      call fwig_temp_free();
      call fwig_table_free();

      end program flookup
